<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C67 | Roblox Hub</title>
<style>
/* RESET */
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', sans-serif; }

/* COLORS */
:root {
  --primary:#ff3cff;
  --secondary:#00ffff;
  --bg:#0a0a0a;
  --card-bg:#111;
  --text-light:#ccc;
}

/* BODY */
body { background:var(--bg); color:#fff; padding:2rem; text-align:center; }

/* HEADER */
h1 {
  font-size:3rem;
  background: linear-gradient(90deg,var(--primary),var(--secondary));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:1rem;
}

/* SEARCH BAR */
#search {
  width: 60%;
  max-width: 400px;
  padding: 0.6rem 1rem;
  margin-bottom: 1rem;
  border-radius: 8px;
  border: 2px solid var(--primary);
  background: #111;
  color: #fff;
  font-size: 1rem;
}

#search::placeholder { color: var(--text-light); }

/* REFRESH BUTTON */
button.refresh-btn {
  background: linear-gradient(90deg,var(--primary),var(--secondary));
  border:none;
  padding:0.7rem 1.8rem;
  color:#000;
  font-weight:bold;
  cursor:pointer;
  margin-top:1rem;
  border-radius:10px;
  transition:transform 0.2s, box-shadow 0.2s;
  font-size:1rem;
}

button.refresh-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px var(--primary), 0 0 20px var(--secondary);
}

/* GAMES GRID */
#games {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:2rem;
  margin-top:2rem;
  padding:0 1rem;
}

/* GAME CARD */
.game-card {
  background:var(--card-bg);
  border:2px solid var(--primary);
  border-radius:15px;
  overflow:hidden;
  transition:transform 0.3s, box-shadow 0.3s, border-color 0.3s;
}

.game-card:hover {
  transform:translateY(-8px);
  box-shadow:0 0 20px var(--primary),0 0 25px var(--secondary);
  border-color: var(--secondary);
}

.game-card img {
  width:100%;
  display:block;
  transition:transform 0.3s;
}

.game-card img:hover { transform:scale(1.05); }

.game-card .content {
  padding:1rem;
  text-align:left;
}

.game-card h3 { margin-bottom:0.5rem; font-size:1.2rem; color: var(--secondary); }

.game-card p { font-size:0.85rem; color: var(--text-light); margin:2px 0; }

.game-card a button {
  width:100%;
  background:linear-gradient(90deg,var(--secondary),var(--primary));
  border:none;
  padding:0.5rem;
  font-weight:bold;
  color:#000;
  border-radius:8px;
  cursor:pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.game-card a button:hover {
  transform:scale(1.05);
  box-shadow:0 0 10px var(--primary),0 0 15px var(--secondary);
}

@media(max-width:768px){
  h1 { font-size:2.2rem; }
  button.refresh-btn { padding:0.6rem 1.5rem; font-size:0.9rem; }
}
</style>
</head>
<body>

<h1>C67 | Roblox Hub</h1>
<input type="text" id="search" placeholder="Search games...">
<button class="refresh-btn" onclick="loadGames(true)">Refresh Games</button>

<div id="games">Loading games...</div>

<script>
let allGames = []; // store fetched games
let displayedGames = 0; // for infinite scroll
const increment = 6; // games to load each scroll

async function loadGames(force=false) {
  const container = document.getElementById('games');
  if(force) displayedGames = 0; 
  container.innerHTML = 'Loading...';

  try {
    const response = await fetch('/api/games');
    const data = await response.json();
    if(!data.success) {
      container.innerHTML = 'Failed to fetch games.';
      return;
    }

    allGames = data.games;
    container.innerHTML = '';
    displayGames();
  } catch(err) {
    container.innerHTML = 'Error fetching games.';
    console.error(err);
  }
}

// Display games with infinite scroll
function displayGames() {
  const container = document.getElementById('games');
  const searchTerm = document.getElementById('search').value.toLowerCase();
  const filtered = allGames.filter(g => g.name.toLowerCase().includes(searchTerm));

  const slice = filtered.slice(displayedGames, displayedGames + increment);
  slice.forEach(game => {
    const card = document.createElement('div');
    card.className = 'game-card';
    card.innerHTML = `
      <img src="${game.thumbnail}" alt="${game.name}">
      <div class="content">
        <h3>${game.name}</h3>
        <p>Active: ${game.activePlayers.toLocaleString()}</p>
        <p>Visits: ${game.visits.toLocaleString()}</p>
        <p>Likes: ${game.likes.toLocaleString()} | Dislikes: ${game.dislikes.toLocaleString()}</p>
        <p>Genre: ${game.genre}</p>
        <a href="https://www.roblox.com/games/${game.gameId}" target="_blank"><button>Play Now</button></a>
      </div>`;
    container.appendChild(card);
  });

  displayedGames += increment;
}

// Infinite scroll
window.addEventListener('scroll', () => {
  if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 100) {
    displayGames();
  }
});

// Search
document.getElementById('search').addEventListener('input', () => {
  displayedGames = 0;
  document.getElementById('games').innerHTML = '';
  displayGames();
});

// Load on start
loadGames();
</script>

</body>
</html>
